--- a/src/rule.c
+++ b/src/rule.c
@@ -1,5 +1,6 @@
 /*
  * Copyright (c) 2008-2020 Patrick McHardy <kaber@trash.net>
+ * Copyright (c) 2024 OpenWrt authors
  *
  * This program is free software; you can redistribute it and/or modify
  * it under the terms of the GNU General Public License version 2 as
@@ -36,8 +37,12 @@
 #include <linux/netfilter.h>
 #include <linux/netfilter_arp.h>
 #include <linux/netfilter_bridge.h>
-#include <linux/if_pppox.h>
 #include <linux/if_vlan.h>
 
+/* 条件包含 if_pppox.h */
+#if defined(HAVE_LINUX_IF_PPPOX_H) || defined(__GLIBC__)
+#include <linux/if_pppox.h>
+#endif
+
 #include <expression.h>
 #include <statement.h>
 #include <rule.h>
